# Morse-Code Protected Calculator
> [!IMPORTANT]  
> Project Demo is Available Here: https://wkydon.pythonanywhere.com/
## About this Project
- This Project is created for Authly (a Hack Club YSWS) by Don Wong.
- This Flask App Serves to Demonstrate the Custom Morse-Code Authentication System.
<br> <br> **More About Me** <br> This is my first time creating anything related to Flask or Authentication, <br>so if the idea is rubbish or it looks bad, please be easy on me...
## Project Details
| App Route | Usage                                           |
|-----------|-------------------------------------------------|
| /         | A simple homepage for the app.                  |
| /login    | Login here after you have created your account! |
| /register | Register here if you do not have an account!    |
## How it works:
- Registration Logic
  - User inputs username, which is checked against the users.json to see if there is already a user with the same username.
  - User inputs password by pressing the Morse-Code button*, which turns the time pressed into dots(.) and dashes(-). Spaces are also allowed in the password field.
    - Password is checked for valid Morse-Code via `re.fullmatch(r'[.\- ]*', password)`
    - This means that the password must ONLY have (i.e. FULLmatch) the characters ".", "-" and " "(space). The * at the end means that this policy can be repeated, meaning there can be more than one of those characters.
  - The password is then hashed with `werkzeug.security.generate_password_hash` and stored in the users.json file.
    - This makes sure if the users.json file ever (hopefully not) get leaked, the attacker will not be able to view the password in plain.
- Login Logic
  - When a user enters their username and password (via morse code button), it is then checked against the users.json file with the `werkzeug.security.check_password_hash` function `(app.py line 63)`
  - 
- Morse Code Button Logic
  - We can see in login.html (inside templates folder), there is a script for the login button from `login.html line 18-56`
    - Basically what it does is:
      1. When the button is pressed down, it counts the time.
      2. When the button is released, it store the last recorded time as the constant `duration` (line 40)
      3. The `duration` is the checked against the threshold `(login.html line 45, default is 300 ms)` and if the duration is less than 300 ms, a dot(.) will be entered in the password field, otherwise, if the time is longer than 300 ms, a dash(-) will be entered in the password field.
    - The Button also plays a 600hz tone when the button is pressed down, this tone is generated by a oscillator. `(login.html lines 27-36)`
  - If the screen viewing the register/login pages is less than 480 px in width, the buttons will automatically be shown as 2 separate buttons for dots(.) and dashes(-).
    - This is achieved using the `@media` block in `/static/styles.css`.
# Installation
>Warning: The installation steps provided may vary depending on your system configuration. Don Wong assumes no liability for any damage that may occur to your system.

> This guide is based on a **WIndows** Machine.
## Prerequisites
- Python (3.xx)
- pip
- Flask
## Creating a Virtual Environment
- Open terminal in the project location
  <br>(On Windows 11, open the Right Click Context Menu and select `Open in Terminal`)
- Run the following commands:
<br>`python -m venv .venv`
<br>`cd .venv\Scripts`
<br>`activate` (Or run the activate.bat file)
**<br>You have now entered the Python Virtual Environment (venv)**
## Installing the Packages
`pip install -r requirements.txt`
## Configuring the app
Create a file called `users.json` and in it just put a pair of square brackets (`[]`)
>**IMPORTANT** <br> Open main.py with a text editor of your choice and change the `app.config['SECRET_KEY'] = "Thisisverysecret"` on line 8 to something hard to guess. 
## Running the App
`flask run --host=0.0.0.0 --port 8080`

>You can now access the app at [localhost:8080](localhost:8080)
